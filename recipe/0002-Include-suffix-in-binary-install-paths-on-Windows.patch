From a6ecf49c0ddaac1ab92b47242952451cbf0a4e5b Mon Sep 17 00:00:00 2001
From: Michael Carroll <michael@openrobotics.org>
Date: Tue, 23 Aug 2022 15:21:14 -0500
Subject: [PATCH 2/2] Include suffix in binary install paths on Windows

Signed-off-by: Michael Carroll <michael@openrobotics.org>
---
 CMake/Utils/OgreConfigTargets.cmake | 53 +++++++++++------------------
 1 file changed, 20 insertions(+), 33 deletions(-)

diff --git a/CMake/Utils/OgreConfigTargets.cmake b/CMake/Utils/OgreConfigTargets.cmake
index d8e020860a..42757e93a5 100644
--- a/CMake/Utils/OgreConfigTargets.cmake
+++ b/CMake/Utils/OgreConfigTargets.cmake
@@ -41,36 +41,23 @@ if (NOT OGRE_RUNTIME_OUTPUT)
   set(OGRE_RUNTIME_OUTPUT ${OGRE_BINARY_DIR}/bin)
 endif ()
 
-if (WIN32)
-  set(OGRE_RELEASE_PATH "/Release")
-  set(OGRE_RELWDBG_PATH "/RelWithDebInfo")
-  set(OGRE_MINSIZE_PATH "/MinSizeRel")
-  set(OGRE_DEBUG_PATH "/Debug")
+set(OGRE_RELEASE_PATH "")
+set(OGRE_RELWDBG_PATH "")
+set(OGRE_MINSIZE_PATH "")
+set(OGRE_DEBUG_PATH "")
+set(OGRE_LIB_RELEASE_PATH "")
+set(OGRE_LIB_RELWDBG_PATH "")
+set(OGRE_LIB_MINSIZE_PATH "")
+set(OGRE_LIB_DEBUG_PATH "")
+if(APPLE AND OGRE_BUILD_PLATFORM_APPLE_IOS)
   set(OGRE_LIB_RELEASE_PATH "/Release")
-  set(OGRE_LIB_RELWDBG_PATH "/RelWithDebInfo")
-  set(OGRE_LIB_MINSIZE_PATH "/MinSizeRel")
-  set(OGRE_LIB_DEBUG_PATH "/Debug")
-  set(OGRE_PLUGIN_PATH "/opt")
-  set(OGRE_SAMPLE_PATH "/opt/samples")
-elseif (UNIX)
-  set(OGRE_RELEASE_PATH "")
-  set(OGRE_RELWDBG_PATH "")
-  set(OGRE_MINSIZE_PATH "")
-  set(OGRE_DEBUG_PATH "")
-  set(OGRE_LIB_RELEASE_PATH "")
-  set(OGRE_LIB_RELWDBG_PATH "")
-  set(OGRE_LIB_MINSIZE_PATH "")
-  set(OGRE_LIB_DEBUG_PATH "")
-  if(APPLE AND OGRE_BUILD_PLATFORM_APPLE_IOS)
-    set(OGRE_LIB_RELEASE_PATH "/Release")
-  endif(APPLE AND OGRE_BUILD_PLATFORM_APPLE_IOS)
-  if (APPLE)
-    set(OGRE_PLUGIN_PATH "/")
-  else()
-    set(OGRE_PLUGIN_PATH "/${OGRE_NEXT_PREFIX}")
-  endif(APPLE)
-  set(OGRE_SAMPLE_PATH "/${OGRE_NEXT_PREFIX}/Samples")
-endif ()
+endif(APPLE AND OGRE_BUILD_PLATFORM_APPLE_IOS)
+if (APPLE)
+  set(OGRE_PLUGIN_PATH "/${OGRE_NEXT_PREFIX}")
+else()
+  set(OGRE_PLUGIN_PATH "/${OGRE_NEXT_PREFIX}")
+endif(APPLE)
+set(OGRE_SAMPLE_PATH "/${OGRE_NEXT_PREFIX}/Samples")
 
 # create vcproj.user file for Visual Studio to set debug working directory
 function(ogre_create_vcproj_userfile TARGETNAME)
@@ -130,28 +117,28 @@ function(ogre_install_target TARGETNAME SUFFIX EXPORT)
 	else()
 	  install(TARGETS ${TARGETNAME}
 		BUNDLE DESTINATION "bin${OGRE_RELEASE_PATH}" CONFIGURATIONS Release None ""
-		RUNTIME DESTINATION "bin${OGRE_RELEASE_PATH}" CONFIGURATIONS Release None ""
+    RUNTIME DESTINATION "bin${OGRE_RELEASE_PATH}${SUFFIX}" CONFIGURATIONS Release None ""
 		LIBRARY DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_LIB_RELEASE_PATH}${SUFFIX}" CONFIGURATIONS Release None ""
 		ARCHIVE DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_LIB_RELEASE_PATH}${SUFFIX}" CONFIGURATIONS Release None ""
 		FRAMEWORK DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_RELEASE_PATH}/Release" CONFIGURATIONS Release None ""
       )
 	  install(TARGETS ${TARGETNAME}
 		BUNDLE DESTINATION "bin${OGRE_RELWDBG_PATH}" CONFIGURATIONS RelWithDebInfo
-		RUNTIME DESTINATION "bin${OGRE_RELWDBG_PATH}" CONFIGURATIONS RelWithDebInfo
+    RUNTIME DESTINATION "bin${OGRE_RELWDBG_PATH}${SUFFIX}" CONFIGURATIONS RelWithDebInfo
 		LIBRARY DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_LIB_RELWDBG_PATH}${SUFFIX}" CONFIGURATIONS RelWithDebInfo
 		ARCHIVE DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_LIB_RELWDBG_PATH}${SUFFIX}" CONFIGURATIONS RelWithDebInfo
 		FRAMEWORK DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_RELWDBG_PATH}/RelWithDebInfo" CONFIGURATIONS RelWithDebInfo
       )
 	  install(TARGETS ${TARGETNAME}
 		BUNDLE DESTINATION "bin${OGRE_MINSIZE_PATH}" CONFIGURATIONS MinSizeRel
-		RUNTIME DESTINATION "bin${OGRE_MINSIZE_PATH}" CONFIGURATIONS MinSizeRel
+    RUNTIME DESTINATION "bin${OGRE_MINSIZE_PATH}${SUFFIX}" CONFIGURATIONS MinSizeRel
 		LIBRARY DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_LIB_MINSIZE_PATH}${SUFFIX}" CONFIGURATIONS MinSizeRel
 		ARCHIVE DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_LIB_MINSIZE_PATH}${SUFFIX}" CONFIGURATIONS MinSizeRel
 		FRAMEWORK DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_MINSIZE_PATH}/MinSizeRel" CONFIGURATIONS MinSizeRel
       )
 	  install(TARGETS ${TARGETNAME}
 		BUNDLE DESTINATION "bin${OGRE_DEBUG_PATH}" CONFIGURATIONS Debug
-		RUNTIME DESTINATION "bin${OGRE_DEBUG_PATH}" CONFIGURATIONS Debug
+    RUNTIME DESTINATION "bin${OGRE_DEBUG_PATH}${SUFFIX}" CONFIGURATIONS Debug
 		LIBRARY DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_LIB_DEBUG_PATH}${SUFFIX}" CONFIGURATIONS Debug
 		ARCHIVE DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_LIB_DEBUG_PATH}${SUFFIX}" CONFIGURATIONS Debug
 		FRAMEWORK DESTINATION "${OGRE_LIB_DIRECTORY}${OGRE_DEBUG_PATH}/Debug" CONFIGURATIONS Debug
-- 
2.34.1

